/*** *     _____       _            _           _                   ______ _     _       _   _ *    /  __ \     | |          | |         | |                  |  _  (_)   | |     | | (_) *    | /  \/ __ _| | ___ _   _| | __ _  __| | ___  _ __ __ _   | | | |_  __| | __ _| |_ _  ___ __ _ *    | |    / _` | |/ __| | | | |/ _` |/ _` |/ _ \| '__/ _` |  | | | | |/ _` |/ _` | __| |/ __/ _` | *    | \__/\ (_| | | (__| |_| | | (_| | (_| | (_) | | | (_| |  | |/ /| | (_| | (_| | |_| | (_| (_| | *     \____/\__,_|_|\___|\__,_|_|\__,_|\__,_|\___/|_|  \__,_|  |___/ |_|\__,_|\__,_|\__|_|\___\__,_| * * */// Autora: Júlia Sales, Periodo : 3B// Primeira questão: 24/08// Segunda questão: 30/08 (esqueci de checar os horários desses 2)// Terceira questão: 02/09 22:01// Ps: Tenho laudo e o combinado é que a entrega fosse até 02/09#include <stdio.h>#include <stdlib.h>#include "unistd.h"typedef struct Node {  int num;  struct Node *next;} Node;void imprimir_elementos(Node *head);void guardar_elementos(Node **head, int res);void free_memoria(Node *head);void calcular_base(int *n,int base);void calcular_BCD(int *n);void calcular_complemento_a2(int *n);void float_double(double n);int main(void) {    double input;    int n;    int escolha;    printf("\t\n------- Calculadora Didática --------\n");    do{        sleep(1);        printf("\n Escolha um processo:\n"             "\n 1- Calcular base 2"             "\n 2- Calcular base 8"             "\n 3- Calcular base 16"             "\n 4- Calcular BCD"             "\n 5- Transformar base 10 para base com sinal com 16 bits (Complemento A2) "             "\n 6- Converter real em decimal para float e double"             "\n 7- Sair \n");        scanf("\n %d", &escolha);        if (escolha>0 && escolha<6){            printf("\n Escolha um número para calcular: ");            scanf("%lf", &input);            n=(int)input;      }      switch (escolha){          case 1:              calcular_base(&n,2);              break;          case 2:              calcular_base(&n,8);              break;          case 3:              calcular_base(&n,16);              break;          case 4:              calcular_BCD(&n);              break;          case 5:              calcular_complemento_a2(&n);              break;          case 6:              double n2;              printf("\n Escolha um número para calcular: ");              scanf("%lf", &n2);              float_double(n2);              break;          case 7:              break;          default:              printf("\n Opção inválida");              break;      }  }while(escolha!=7);  return 0;}void imprimir_elementos(Node *head) {    while (head != NULL) {        if (head->num >= 10 && head->num <= 15) {            printf("%c", 'A' + (head->num - 10));        } else {            printf("%d", head->num);        }        head = head->next;    }}void guardar_elementos(Node **head, int res) {    Node *novo = (Node*)malloc(sizeof(Node));    if (novo != NULL) {        novo->num = res;        novo->next = *head;        *head = novo;    }}void free_memoria(Node *head){    while(head !=NULL) {        Node *temp = head;        head=head->next;        free(temp);    }}void calcular_base(int *n, int base) {    Node *head = NULL;    if(*n<0){        *n= *n * -1;    }    printf("\nConversão do número decimal %d para base %d:", *n, base);    while (1) {        int res = *n % base;        if (*n <= 1) {            printf("\n %d/%d não tem resto inteiro, então é %d", *n, base, *n);            sleep(1);        } else {            if (res>9) {                printf(", que vira %c, pois o resto passou de 10",res-10+'A');            }            printf("\n %d/%d tem resto: %d", *n, base, res);            sleep(1);        }        *n = *n/base;        guardar_elementos(&head, res);        if (*n < 1) {            printf("\n Invertendo todos os dígitos...");            sleep(1);            printf("\n O total é: ");            imprimir_elementos(head);            printf("\n");            sleep(1);            break;        }    }    free_memoria(head);}void calcular_BCD(int *n) {    Node *head = NULL;    if(*n<0){        *n= *n * -1;    }    printf("\nConversão do número decimal %d para BCD:", *n);    sleep(1);    int cont=1;    while (*n>0) {        int digito = *n%10;        printf("\nPasso %d: Convertendo o dígito %d para BCD (4 bits): ",cont, digito);        sleep(1);        for (int i=0; i<4; i++) {            int bit = (digito >> i) & 1;            guardar_elementos(&head, bit);        }        imprimir_elementos(head);        *n=*n/10;        cont++;    }    sleep(1);    printf("\n O total é: ");    imprimir_elementos(head);    printf("\n");    free_memoria(head);}void calcular_complemento_a2(int *n) {    Node *head1 = NULL;    Node *head2 = NULL;    int bits[16] = {0};    int negativo = 0;    printf("\n Representação de %d em complemento de 2 com 16 bits: ", *n);    sleep(1);    if (*n < 0) {        *n = *n * -1;        negativo = 1;    }printf("\n Transforma o número em binário com 16 bits: ");    sleep(1);    for (int i = 0; i<16; i++) {        bits[15 - i] = *n % 2;        *n /= 2;    }    for (int i = 15; i >= 0; i--) {        guardar_elementos(&head1, bits[i]);    }    imprimir_elementos(head1);    if (negativo == 1) {        printf("\n Agora inverte todos o bits: ");        for (int i = 0; i < 16; i++) {            printf("\n %d vira: ",bits[i]);            bits[i] = !bits[i];            printf("%d ",bits[i]);            sleep(1);        }printf("\n E somando +1 aos bits invertidos o resultado é: ");        for (int i = 15; i >= 0; i--) {            if (bits[i] == 0) {                bits[i] = 1;                break;            } else {                bits[i] = 0;            }        }        for (int i = 15; i>=0; i--) {            guardar_elementos(&head2, bits[i]);        }        sleep(1);        imprimir_elementos(head2);        printf("\n");    }    free_memoria(head1);    free_memoria(head2);}void float_double(double n) {    Node *headSinal1 = NULL;    Node *headExpoente1 = NULL;    Node *headFracao1 = NULL;    Node *headSinal2 = NULL;    Node *headExpoente2 = NULL;    Node *headFracao2 = NULL;    float f = (float)n;    unsigned int *ptr1 = (unsigned int*)&f;    unsigned long long *ptr2 = (unsigned long long*)&n;    unsigned int bits1 = *ptr1;    int sinal1 = (bits1 >> 31) & 1;    int expoente1 = (bits1 >> 23) & 0xFF;    int fracao1 = bits1 & 0x7FFFFF;    guardar_elementos(&headSinal1, sinal1);    unsigned long long bits2 = *ptr2;    int sinal2 = (bits2 >> 63) & 1;    int expoente2 = (bits2 >> 52) & 0x7FF;    long long fracao2 = bits2 & 0xFFFFFFFFFFFFF;    guardar_elementos(&headSinal2, sinal2);    printf("Representação de número em float (32 bits): \n");    sleep(1);    printf("\nPasso 1: Extrair o bit de sinal (1 bit).\n");    sleep(1);    printf("Sinal: %d (0 para positivo, 1 para negativo)\n", sinal1);    sleep(1);    printf("\nPasso 2: Extrair o expoente (8 bits).\n");    sleep(1);    printf("Expoente em bits: ");    for (int i = 7; i >= 0; i--) {        int bit = (expoente1 >> i) & 1;        printf("%d", bit);        guardar_elementos(&headExpoente1, bit);    }    printf(" (Valor decimal: %d, sem o viés de 127)\n", expoente1 - 127);    sleep(1);    printf("\nPasso 3: Extrair a fração (23 bits).\n");    sleep(1);    printf("Mantissa em bits: ");    for (int i = 22; i >= 0; i--) {        int bit = (fracao1 >> i) & 1;        printf("%d", bit);        guardar_elementos(&headFracao1, bit);    }    printf("\n");    sleep(1);    printf("\n___________________________________________");    printf("\nRepresentação do número em double (64 bits): \n");    sleep(1);    printf("\nPasso 1: Extrair o bit de sinal (1 bit).\n");    sleep(1);    printf("Sinal: %d (0 para positivo, 1 para negativo)\n", sinal2);    sleep(1);    printf("\nPasso 2: Extrair o expoente (11 bits).\n");    sleep(1);    printf("Expoente em bits: ");    for (int i = 10; i >= 0; i--) {        int bit = (expoente2 >> i) & 1;        printf("%d", bit);        guardar_elementos(&headExpoente2, bit);    }    printf(" (O valor decimal é: %d, sem o viés de 1023)\n", expoente2 - 1023);    sleep(1);    printf("\nPasso 3: Extrair a fração (52 bits).\n");    sleep(1);    printf("Mantissa em bits: ");    for (int i = 51; i >= 0; i--) {        int bit = (fracao2 >> i) & 1;        printf("%d", bit);        guardar_elementos(&headFracao2, bit);    }    printf("\n");    sleep(2);    printf("\n___________________________________________");    printf("\nRepresentação em float:\n");    sleep(1);    printf("Bits de sinal: ");    imprimir_elementos(headSinal1);    sleep(1);    printf("\nBits de expoente: ");    imprimir_elementos(headExpoente1);    sleep(1);    printf("\nBits de fração: ");    imprimir_elementos(headFracao1);    printf("\nO número em float é: ");    imprimir_elementos(headSinal1);    imprimir_elementos(headExpoente1);    imprimir_elementos(headFracao1);    sleep(1.5);    printf("\n___________________________________________");    printf("\n\nRepresentação em double\n");    sleep(1);    printf("Bits de sinal: ");    imprimir_elementos(headSinal2);    sleep(1);    printf("\nBits de expoente: ");    imprimir_elementos(headExpoente2);    sleep(1);    printf("\nBits de fração: ");    imprimir_elementos(headFracao2);    sleep(1);    printf("\nO número total em double é: ");    imprimir_elementos(headSinal2);    imprimir_elementos(headExpoente2);    imprimir_elementos(headFracao2);    free_memoria(headSinal1);    free_memoria(headSinal2);    free_memoria(headExpoente1);    free_memoria(headExpoente2);    free_memoria(headFracao1);    free_memoria(headFracao2);}